if (self.CavalryLogger) { CavalryLogger.start_js(["wP+bH"]); }

__d("PagesLikeFollowNotifActions",[],(function a(b,c,d,e,f,g){f.exports={INIT_DATA:"init_data",LIKE:"like",UNLIKE:"unlike",FOLLOW_CHANGED:"follow_changed",NOTIF_CHANGE:"notif_change",NOTIF_ALL_ON:"notif_all_on",NOTIF_ALL_OFF:"notif_all_off",NEWS_FEED_CHANGE:"news_feed_change"};}),null);
__d("TimelineViewportTrackingLogType",[],(function a(b,c,d,e,f,g){f.exports={IMPRESSION:"impression",DURATION:"duration"};}),null);
__d('DimensionLogging',['BanzaiNectar','getViewportDimensions'],(function a(b,c,d,e,f,g){var h=c('getViewportDimensions')();c('BanzaiNectar').log('browser_dimension','homeload',{x:h.width,y:h.height,sw:window.screen.width,sh:window.screen.height,aw:window.screen.availWidth,ah:window.screen.availHeight,at:window.screen.availTop,al:window.screen.availLeft});}),null);
__d('KeyboardShortcuts',['KeyEventController','Layer','ModalLayer'],(function a(b,c,d,e,f,g){function h(j,k,l){'use strict';this.key=j;this.handler=k;this.filter=l;this.register();}h.prototype.register=function(){'use strict';this.token=c('KeyEventController').registerKey(this.key,this.handler,this.filter);};h.prototype.remove=function(){'use strict';this.token.remove();};var i={_tokens:[[]],register:function j(k,l,m){m=m||{};var n=m.allowDefault?l:function(event,r){l.apply(this,arguments);event.prevent();},o=m.baseFilters||[c('KeyEventController').defaultFilter],p=function r(event,s){for(var t=0,u=o.length;t<u;t++)if(!o[t](event,s))return false;return !m.filter||m.filter(event,s);},q=new h(k,n,p);if(!this._tokens.length)this._tokens.push([]);this._tokens[this._tokens.length-1].push(q);return q;},init:function j(){c('Layer').subscribe('show',function(k,l){if(l.hasBehavior(c('ModalLayer')))this.pushLayer();}.bind(this));c('Layer').subscribe('hide',function(k,l){if(l.hasBehavior(c('ModalLayer')))this.popLayer();}.bind(this));},pushLayer:function j(){var k=this._tokens[this._tokens.length-1];k&&k.forEach(function(l){l.remove();});this._tokens.push([]);},popLayer:function j(){var k=this._tokens.length-1;if(k<0)return;var l=this._tokens[k];l.forEach(function(n){n.remove();});this._tokens.pop();var m=this._tokens[k-1];m&&m.forEach(function(n){n.register();});}};i.init();f.exports=i;}),null);
__d('ViewportTrackingHooks',['Base64'],(function a(b,c,d,e,f,g){var h={},i=[],j={registerFeedObject:function k(l,m){h[l]=c('Base64').encode(m);},updateVisibleViewportObjects:function k(l){var m=[],n=false;for(var o=0;o<l.length;o++){var p=l[o],q=p.id;while(!(q in h)&&p.firstChild!=undefined&&p.firstChild.id!=undefined&&p.firstChild.id.startsWith("u_")){q=p.firstChild.id;p=p.firstChild;}if(q in h){m.push(h[q]);if(!(o in i)||i[o]!=h[q])n=true;}}if(!n&&i.length!=m.length)n=true;if(n){i=m;if(typeof __EXT__updateVisibleViewportObjects==='function')__EXT__updateVisibleViewportObjects(i);}}};f.exports=j;}),null);
__d('viewportTrackingBuilder',[],(function a(b,c,d,e,f,g){'use strict';var h=function i(j){var k=null;return {factory:j,singleton:function l(){if(!k)k=j.apply(undefined,arguments);return k;},clearSingleton:function l(){k=null;}};};f.exports=h;}),null);
__d('ViewportTracking',['cx','invariant','Arbiter','Banzai','BanzaiScuba','CSS','CurrentUser','DOM','DOMDimensions','Event','LitestandMessages','NavigationMessage','pageID','Run','SubscriptionsHandler','TimeSlice','UserActivity','ViewportTrackingHelper','ViewportTrackingHooks','clickRefAction','collectDataAttributes','debounce','getElementPosition','getViewportDimensions','throttle','viewportTrackingBuilder','setTimeout'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=97,k='vpv',l=3,m=2,n=1,o=0,p=1,q=2,r=3,s=4;function t(w){this.cachedAllStories=[];this.cachedVisibleStories={init:false,data:{}};this.fireTimer=this.fireTimer.bind(this);this.logAnnotatedVPV=this.logAnnotatedVPV.bind(this);this.markStoryRead=this.markStoryRead.bind(this);this.behavior=w;}t.prototype.init=function(w){this.useBanzai=true;this.vpvDebug=!!w.vpv_debug;this.vpvdDebug=!!w.vpvd_debug;this.vpvdAnalysis=!!w.vpvd_analysis;this.trackingHooks=!!w.tracking_hooks;this.ctaLoggingEnabled=!!w.cta_logging_enabled;this.readStoryIDs={};this.annotatedStoryIDs={};this.minSizeToBeVisible=200;this.minFractionToBeVisibleForTimetracking=.5;this.scrollThrottlingInterval=100;this.mouseThrottlingInterval=100;this.keyboardThrottlingInterval=100;this.minTimeToReportImmediately=500;this.discardVPVDIntervalThreshold=90000;this.active_state_duration=1000;this.height_diff_to_change_state=25;this.focused_state_duration=3500;this.invalidateAllStoriesCache();this.cachedViewportHeight=c('getViewportDimensions')().height;this.isTimetrackingEnabled=false;this.activeStories={};this.userInactiveLock=false;this.userActivityPollerTimeoutID=-1;this._headLoadStoryCount=0;if(this.behavior.getDataFromConfig)this.behavior.getDataFromConfig(w,this);if(this.isTimetrackingEnabled){this.lastMouseX=-1;this.lastMouseY=-1;this.lastStreamY=-1;this.latestStreamYChangedTimeStamp=-1;this.userFocus=q;this.latestUserFocus=q;this.latestUserActivity='init';this.focusedStory=null;this.latestFocusedStory=null;this.latestActiveStory=null;this.totalVPVDuration={};}if(w.tracking_duration_config){this.scrollThrottlingInterval=w.tracking_duration_config.scroll_throttling_interval;this.mouseThrottlingInterval=w.tracking_duration_config.mouse_throttling_interval;this.keyboardThrottlingInterval=w.tracking_duration_config.keyboard_throttling_interval;this.userActivityPollingInterval=w.tracking_duration_config.user_activity_polling_interval;this.timeToBeConsideredInactive=w.tracking_duration_config.time_to_be_considered_inactive;this.minFractionToBeVisibleForTimetracking=w.tracking_duration_config.min_fraction_to_be_visible;this.minTimeToReportImmediately=w.tracking_duration_config.min_time_to_report_immediately;this.active_state_duration=w.tracking_duration_config.active_state_duration;this.height_diff_to_change_state=w.tracking_duration_config.story_height_diff_to_change_state;this.focused_state_duration=w.tracking_duration_config.focused_state_duration;this.discardVPVDIntervalThreshold=w.tracking_duration_config.discard_vpvd_interval_threshold;}w.record_delay!==undefined||i(0);var x=c('debounce')(this.fireTimer,w.record_delay,this);this.initialStories=this.getStoriesInView();this.initialStoriesLogged=false;if(this.annotatedVPVLogging)this.initialStories.forEach(this.logAnnotatedVPV,this);this.subscriptions=new (c('SubscriptionsHandler'))();this.subscriptions.addSubscriptions(this._getScrollListener(x),c('Event').listen(window,'resize',function(){this.invalidateVisibleStoriesCache();this.cachedViewportHeight=c('getViewportDimensions')().height;x();}.bind(this)),c('Event').listen(window,'focus',function(){if(this.isTimetrackingEnabled)this.updateTimeTrackingData(false,'window_focus');}.bind(this)),c('Event').listen(window,'blur',function(){if(this.isTimetrackingEnabled)this.updateTimeTrackingData(true,'window_blur');}.bind(this)),c('Arbiter').subscribe(c('NavigationMessage').NAVIGATION_BEGIN,this.cleanup.bind(this)),c('Arbiter').subscribe('Stream/totalHeadLoadedStories',function(ba,ca){this._headLoadStoryCount=ca.count;}.bind(this)),c('Arbiter').subscribe(c('LitestandMessages').STORIES_INSERTED,function(){if(!this.initialStoriesLogged){var ba=this.getStoriesInView();ba.forEach(this.logAnnotatedVPV,this);}else x();if(this.isTimetrackingEnabled)this.updateTimeTrackingData(false,'stories_inserted');}.bind(this)));if(this.isTimetrackingEnabled&&this.behavior.getStream){this.updateTimeTrackingData(false,'init');var y=c('throttle')(function(event){this.invalidateVisibleStoriesCache();this.handleScroll(event);}.bind(this),this.scrollThrottlingInterval),z=c('throttle')(function(event){return this.handleKeyboard(event);}.bind(this),this.keyboardThrottlingInterval),aa=c('throttle')(function(event){return this.handleMouse(event);}.bind(this),this.mouseThrottlingInterval);this.subscriptions.addSubscriptions(c('Event').listen(window,'scroll',y),c('Event').listen(document.documentElement,'DOMMouseScroll',y,undefined,{passive:true}),c('Event').listen(document.documentElement,'mousewheel',y,undefined,{passive:true}),c('Event').listen(document.documentElement,'keydown',z),c('Event').listen(document.documentElement,'mouseover',aa),c('Event').listen(document.documentElement,'mousemove',aa),c('Event').listen(document.documentElement,'click',function(event){this.handleMouse(event);}.bind(this)),c('Arbiter').subscribe('Event/stop',function(ba,ca){this.handleMouse(ca.event);}.bind(this)),c('Arbiter').subscribe('PhotoSnowlift.OPEN',function(){this.userFocus=r;this.handleLayers();}.bind(this)),c('Arbiter').subscribe('PhotoSnowlift.CLOSE',function(){this.userFocus=p;this.focusedStory=null;this.updateTimeTrackingData(false,'snowlift_close');}.bind(this)));this._userActivityPoller();}c('Run').onLeave(this.cleanup.bind(this));c('Run').onUnload(this.cleanup.bind(this));};t.prototype._getScrollListener=function(w){return c('Event').listen(window,'scroll',w);};t.prototype.cleanup=function(){if(this.subscriptions){this.subscriptions.release();this.subscriptions=null;}if(this.isTimetrackingEnabled){clearTimeout(this.userActivityPollerTimeoutID);this.updateTimeTrackingData(true,'cleanup');}if(this.annotatedVPVLogging){var w=this.getStoriesInView();w.forEach(this.logAnnotatedVPV,this);}this.initialStories=[];this._headLoadStoryCount=0;};t.prototype.fireTimer=function(){if(!this.initialStoriesLogged){this.initialStories.forEach(this.markStoryRead,this);this.initialStoriesLogged=true;}this.storiesInView=this.getStoriesInView();this.storiesInView.forEach(this.markStoryRead,this);if(this.trackingHooks){var w=this.isTimetrackingEnabled?this.getVisibleStoriesFromCache():this.getAllStoriesInView(),x=[],y=Object.keys(w);for(var z=0,aa=y.length;z<aa;z++){var ba=y[z];if(w[ba].story)x.push(w[ba].story);}c('ViewportTrackingHooks').updateVisibleViewportObjects(x);}};t.prototype.getSessionID=function(){return null;};t.prototype._userActivityPoller=function(){if(!this.userInactiveLock&&!c('UserActivity').isActive(this.timeToBeConsideredInactive)){this.userInactiveLock=true;this.userFocus=q;this.updateTimeTrackingData(false,'user_activity_inactive');c('UserActivity').subscribeOnce(function(){this.userFocus=p;this.updateTimeTrackingData(false,'user_activity_active');this.userInactiveLock=false;}.bind(this));}this.userActivityPollerTimeoutID=c('setTimeout')(c('TimeSlice').guard(this._userActivityPoller.bind(this),'ViewportTracking poll setTimeout',{isContinuation:false}),this.userActivityPollingInterval);};t.prototype.getQueryID=function(w){return -1;};t.prototype.getFBFeedLocations=function(w){return -1;};t.prototype.getFBFeedInsertionPosition=function(w){return -1;};t.prototype.createVPVDTimer=function(w){var x=document.createElement('label');x.setAttribute('for',w.toString());x.setAttribute('class','vpvd_debug_timer');return x;};t.prototype.updateVPVDTimer=function(w){var x=this.activeStories[w].story;if(!x)return;var y=c('DOM').scry(x,'.vpvd_debug_timer');if(!y.length){y=[this.createVPVDTimer(x),this.createVPVDTimer(x)];var z=c('DOM').scry(x,'.UFIRow');if(z.length&&z[z.length-1].clientWidth>0){z[z.length-1].appendChild(y[0]);}else x.appendChild(y[0]);x.insertBefore(y[1],x.firstChild);}var aa=this.totalVPVDuration[w],ba=Math.floor(aa/1000)+'.'+Math.floor(aa%1000/100);c('DOM').setContent(y[0],ba);c('DOM').setContent(y[1],ba);};t.prototype.updateVPVDTimers=function(){for(var w in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,w))this.updateVPVDTimer(w);};t.prototype.logVpvdAnalysis=function(w,x,y,z,aa,ba){var ca=new (c('BanzaiScuba'))('vpv_duration');ca.addDenorm('qid',this.getQueryID(this.activeStories[w].story));ca.addDenorm('uid',c('CurrentUser').getID());ca.addDenorm('vsid',w);ca.addInteger('time',Math.round(Date.now()/1000));ca.addInteger('duration',z);ca.addInteger('total_duration',aa);ca.addNormal('story_state',this.activeStories[w].state);ca.addNormal('is_active_state',y);ca.addNormal('num_visible_stories',this.numVisibleStories);ca.addInteger('story_height',this.activeStories[w].story_height);ca.addInteger('story_visible_height',this.activeStories[w].height);ca.addInteger('state_visible_height',ba);ca.addInteger('total_visible_height',this.totalVisibleHeight);ca.addInteger('total_height',this.totalHeight);ca.addNormal('user_focus',this.latestUserFocus);ca.addNormal('next_user_focus',this.userFocus);ca.addInteger('vpvd',x);ca.addInteger('accumulated_vpvd',this.activeStories[w].vpvd);ca.addNormal('user_activity',this.latestUserActivity);ca.addNormal('next_user_activity',this.userActivity);ca.addInteger('story_position_y',this.activeStories[w].y);ca.addInteger('feed_insertion_position',this.getFBFeedInsertionPosition(this.activeStories[w].story));ca.addNormal('visible_position',this.activeStories[w].visible_position);ca.addNormal('is_focused_story',this.activeStories[w].is_focused);ca.post();};t.prototype.shouldDiscardStory=function(w){var x=this.activeStories[w].height||0;return x!=this.activeStories[w].story_height&&x<this.totalHeight/2;};t.prototype.calculateTotalHeight=function(){this.totalHeight=0;for(var w in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,w))this.totalHeight+=this.activeStories[w].height;};t.prototype.updateVPVDurations=function(w){var x;if(this.latestUserFocus===q||w-this.latestTimeTrackingTimestamp>this.discardVPVDIntervalThreshold)return;var y=(x={},x[n]=0,x[m]=0,x[l]=0,x),z=w-this.latestTimeTrackingTimestamp>=this.focused_state_duration;this.totalVisibleHeight=0;for(var aa in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,aa))if(!(this.latestUserFocus===p&&z&&this.shouldDiscardStory(aa))){var ba=this.activeStories[aa].state||null,ca=this.activeStories[aa].height||0;if(ba!==null&&Object.prototype.hasOwnProperty.call(y,ba))y[ba]+=ca;this.totalVisibleHeight+=ca;}var da=0,ea=w-this.latestTimeTrackingTimestamp;if(this.latestUserFocus===p){ea=y[l]>0?this.focused_state_duration:this.active_state_duration;ea=Math.min(ea,w-this.latestTimeTrackingTimestamp);da=w-this.latestTimeTrackingTimestamp-ea;}var fa=0,ga=l;for(var ha=l;ha>=n;ha--)if(y[ha]>0){fa=y[ha];ga=ha;break;}var ia=y[l]+y[m]+y[n],ja=0;for(aa in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,aa)){if(this.latestUserFocus===p&&z&&this.shouldDiscardStory(aa))continue;var ka=this.activeStories[aa].state||o;if(fa>0&&ka>=ga){var la=this.activeStories[aa].height||0;ja=ea*(la/fa);if(this.vpvdAnalysis&&ea>0)this.logVpvdAnalysis(aa,ja,true,ea,ea+da,fa);this.activeStories[aa].vpvd+=ja;this.totalVPVDuration[aa]+=ja;}if(ia>0){var ma=this.activeStories[aa].height||0;ja=da*(ma/ia);if(this.vpvdAnalysis&&da>0)this.logVpvdAnalysis(aa,ja,false,da,ea+da,ia);this.activeStories[aa].vpvd+=ja;this.totalVPVDuration[aa]+=ja;}}};t.prototype.updateActiveStory=function(w,x,y,z){this.activeStories[w].state=x;this.activeStories[w].ts=y;this.activeStories[w].height_snapshot=z[w].height;this.activeStories[w].is_focused=this.focusedStory===z[w].story;this.activeStories[w].story_height=z[w].story_height;if(this.vpvdAnalysis){this.activeStories[w].visible_position=z[w].visible_position;this.activeStories[w].y=z[w].y;}};t.prototype.updateActiveStories=function(w,x){for(var y in w)if(Object.prototype.hasOwnProperty.call(w,y))if(y in this.activeStories){var z=w[y].height||0;this.activeStories[y].height=z;var aa=z-(this.activeStories[y].height_snapshot||0);if(this.focusedStory===w[y].story){this.updateActiveStory(y,l,x,w);}else if(aa<=-this.height_diff_to_change_state){this.updateActiveStory(y,this.shouldDiscardStory(y)?o:n,x,w);}else if(aa>=this.height_diff_to_change_state||this.activeStories[y].is_focused||this.activeStories[y].height===this.activeStories[y].story_height)this.updateActiveStory(y,m,x,w);}else{this.activeStories[y]={evp_ts:x,story:w[y].story,height:w[y].height,vpvd:0};if(!this.totalVPVDuration[y])this.totalVPVDuration[y]=0;this.updateActiveStory(y,m,x,w);}};t.prototype.recordVPVDurations=function(w,x){for(var y in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,y))if(x||!(y in w)){var z=this.activeStories[y].vpvd||0;if(z>this.focused_state_duration||z===this.totalVPVDuration[y])this.recordTimeStoryWasInView(this.activeStories[y]);delete this.activeStories[y];}};t.prototype.updateTimeTrackingData=function(w,x){this.userActivity=x;if(!this.activeStories)this.activeStories={};var y=Date.now();if(!this.latestTimeTrackingTimestamp)this.latestTimeTrackingTimestamp=y;var z=this.getVisibleStoriesFromCache();this.calculateTotalHeight();this.updateVPVDurations(y);this.updateActiveStories(z,y);if(this.vpvdDebug)this.updateVPVDTimers();this.recordVPVDurations(z,w);if(w){this.latestTimeTrackingTimestamp=0;}else this.latestTimeTrackingTimestamp=y;this.latestUserActivity=this.userActivity;this.latestUserFocus=this.userFocus;if(this.focusedStory)this.latestActiveStory=this.focusedStory;this.latestFocusedStory=this.focusedStory;this.focusedStory=null;};t.prototype.needsToUpdateTimeTrackingData=function(){return !(this.latestUserFocus===this.userFocus&&(this.userFocus===q||this.userFocus===p&&!this.latestFocusedStory&&!this.focusedStory));};t.prototype.getfocusedStory=function(w){var x=this.getVisibleStoriesFromCache();for(var y in x)if(Object.prototype.hasOwnProperty.call(x,y)){var z=x[y].story;if(z&&c('ViewportTrackingHelper').isDescendantOf(w,z))return z;}return null;};t.prototype.handleLayers=function(){if(this.userFocus===r||this.userFocus===s){this.focusedStory=this.latestActiveStory;this.updateTimeTrackingData(false,'media_layer');return true;}return false;};t.prototype.didInteractWithStream=function(w){if(!this.behavior.getStream)return false;var x=this.behavior.getStream();return c('ViewportTrackingHelper').isDescendantOf(w,x)||c('ViewportTrackingHelper').isDescendantOf(x,w);};t.prototype.handleScroll=function(event){if(this.handleLayers())return;var w=Date.now();this.behavior.getStream||i(0);var x=c('getElementPosition')(this.behavior.getStream()).y;if(x!=this.lastStreamY||w-this.latestStreamYChangedTimeStamp<2.5*this.scrollThrottlingInterval||this.didInteractWithStream(event.target)){this.latestStreamYChangedTimeStamp=w;this.userFocus=p;}else this.userFocus=q;this.lastStreamY=x;if(this.userFocus===p||this.needsToUpdateTimeTrackingData())this.updateTimeTrackingData(false,'scroll');};t.prototype.handleKeyboard=function(event){if(this.handleLayers())return;if(this.didInteractWithStream(event.target)){this.userFocus=p;this.focusedStory=this.getfocusedStory(event.target);}else if(c('CSS').hasClass(event.target,'shareInput')){this.userFocus=p;this.focusedStory=this.latestActiveStory;}else this.userFocus=q;if(this.userFocus===p||this.needsToUpdateTimeTrackingData())this.updateTimeTrackingData(false,'keyboard');};t.prototype.handleMouse=function(event){if(this.handleLayers())return;if(event.type!='click'&&event.clientX===this.lastMouseX&&event.clientY===this.lastMouseY)return;if(event.type==='click')this.invalidateVisibleStoriesCache();if(this.didInteractWithStream(event.target)){this.userFocus=p;this.focusedStory=this.getfocusedStory(event.target);}else this.userFocus=q;this.lastMouseX=event.clientX;this.lastMouseY=event.clientY;if(this.needsToUpdateTimeTrackingData())this.updateTimeTrackingData(false,event.type);};t.prototype.getStoriesInView=function(){var w=this.behavior.getAllStories(),x=[],y=false;for(var z=0;z<w.length;z++){var aa=w[z],ba=this.behavior.getStoryID(aa);if(ba&&this.hasBeenVisible(ba))continue;if(c('ViewportTrackingHelper').isVisible(aa,this.minSizeToBeVisible)){if(aa.getAttribute('data-insertion-position')===null)aa.setAttribute('data-insertion-position',(z-this._headLoadStoryCount).toString());x.push(aa);y=true;}else if(y)break;}return x;};t.prototype.getAllStoriesFromCache=function(){if(this.cachedAllStories.length===0)this.cachedAllStories=this.behavior.getAllStories();return this.cachedAllStories;};t.prototype.invalidateAllStoriesCache=function(){this.cachedAllStories=[];this.invalidateVisibleStoriesCache();};t.prototype.getVisibleStoriesFromCache=function(){if(!this.cachedVisibleStories.init)this.cachedVisibleStories={init:true,data:this.getAllStoriesInView()};return this.cachedVisibleStories.data;};t.prototype.invalidateVisibleStoriesCache=function(){this.cachedVisibleStories={init:false,data:{}};};t.prototype.getAllStoriesInView=function(){var w=this.getAllStoriesFromCache(),x={},y=false,z=0,aa=w.length,ba=1,ca=w.length;if(this._indexOfLastVisibleStoryOnPreviousPass>aa/2){z=aa-1;aa=-1;ba=-ba;}for(var da=z;da!=aa;da+=ba){var ea=w[da],fa=c('ViewportTrackingHelper').getHeightIfVisible(ea,Math.min(this.minSizeToBeVisible,this.minFractionToBeVisibleForTimetracking*c('DOMDimensions').getElementDimensions(ea).height));if(fa>0||ea===this.focusedStory){if(ea.getAttribute('data-insertion-position')===null)ea.setAttribute('data-insertion-position',(da-this._headLoadStoryCount).toString());var ga=this.behavior.getStoryID(ea);if(ga){x[ga]={story:ea,height:fa,story_height:c('DOMDimensions').getElementDimensions(ea).height};y=true;if(this.vpvdAnalysis){x[ga].y=c('getElementPosition')(ea).y;x[ga].visible_position=da;ca=Math.min(ca,da);}}}else if(y){this._indexOfLastVisibleStoryOnPreviousPass=da-ba;break;}}if(this.vpvdAnalysis){this.numVisibleStories=0;for(ga in x)if(Object.prototype.hasOwnProperty.call(x,ga)){x[ga].visible_position-=ca;this.numVisibleStories++;}}return x;};t.prototype.getTimetrackingDataToLog=function(w){var x={evt:j,time_spent_id:c('pageID'),vpvd_start_timestamp:w.evp_ts||null,vpvd_time_delta:Math.round(w.vpvd||0),story_height:c('DOMDimensions').getElementDimensions(w.story).height,viewport_height:this.cachedViewportHeight};return {ft:x};};t.prototype.recordTimeStoryWasInView=function(w){if(!this.isTimetrackingEnabled)return;if(!w.vpvd||!w.story)return;if(w.vpvd>0){var x=this.getTimetrackingDataToLog(w),y=c('collectDataAttributes')(w.story,['ft']);Object.assign(x.ft,y.ft);var z=!!y.ft.ei&&x.ft.vpvd_time_delta>this.minTimeToReportImmediately;if(x.ei)delete x.ei;w.story||i(0);this.sendDataToLog(w.story,x,z);}};t.prototype.hasBeenVisible=function(w){return w in this.readStoryIDs;};t.prototype.sendDataToLog=function(w,x,y){if(this.useBanzai){var z={};if(y)z.delay=3000;var aa=this.getSessionID();if(aa)x.ft.session_id=aa;c('Banzai').post('feed_tracking',x,z);}else c('clickRefAction')(k,w,null,'FORCE',x);};t.prototype.markStoryRead=function(w){var x=this.behavior.getStoryID(w);if(!x||this.hasBeenVisible(x))return;this.readStoryIDs[x]=true;this.annotatedStoryIDs[x]=true;var y=this._getDataToLogImpl(w),z=c('collectDataAttributes')(w,['ft']);Object.assign(y.ft,z.ft);delete y.ei;this.sendDataToLog(w,y,false);if(this.vpvDebug)c('CSS').addClass(w,"_5m7s");};t.prototype.logAnnotatedVPV=function(w){var x=this.behavior.getStoryID(w);if(!x||x in this.annotatedStoryIDs)return;this.annotatedStoryIDs[x]=true;var y=this._getDataToLogImpl(w),z=c('collectDataAttributes')(w,['ft']);Object.assign(y.ft,z.ft);delete y.ei;y.ft.vpv_ft_only=1;this.sendDataToLog(w,y,false);};t.prototype._getDataToLogImpl=function(w){var x=this.behavior.getDataToLog(w);if(!x.ft)x.ft={};return x;};t.clearSingleton=function(){};var u={getAllStories:function w(){return [];},getStoryID:function w(x){return null;},getDataToLog:function w(x){return {};}},v=c('viewportTrackingBuilder')(function(w){return new t(u);});t.factory=v.factory.bind(v);t.singleton=v.singleton.bind(v);t.clearSingleton=v.clearSingleton.bind(v);t.getBehavior=function(){return u;};f.exports=t;}),null);
__d('collectSubtreeData',[],(function a(b,c,d,e,f,g){function h(j,k,l,m,n){if(j.offsetWidth===0&&j.offsetHeight===0)return n;var o={};if(j.getAttribute)for(s=0;s<k.length;s++){u=k[s];var p=j.getAttribute(l[u]);if(p){o[u]={};var q=JSON.parse(p);for(var r in m)if(q[r]!==undefined){o[u][r]=true;if(n[u]===undefined)n[u]={};if(n[u][r]===undefined)n[u][r]=[];if(m[r].length>0)n[u][r].push(m[r]);n[u][r].push('('+q[r]);}}}for(var s=0;s<j.childNodes.length;s++){var t=j.childNodes[s];h(t,k,l,m,n);}for(var u in o)for(var v in o[u]){var w=n[u][v][n[u][v].length-1];if(w.length>0&&w.charAt(0)=='('){n[u][v][n[u][v].length-1]=w.substr(1);}else n[u][v].push(')');}return n;}function i(j,k){var l={};for(var m=0;m<k.length;++m)l[k[m]]='data-'+k[m];var n={tn:"","tn-debug":","},o={};h(j,k,l,n,o);for(var p in o)for(var q in o[p])o[p][q]=o[p][q].join('');return o;}f.exports=i;}),null);
__d('recordTNTreeData',['collectSubtreeData'],(function a(b,c,d,e,f,g){function h(i,j){var k={},l=c('collectSubtreeData')(i,['ft']);for(var m in l.ft){k[m+'_tree']=l.ft[m];if(m==='tn-debug')i.setAttribute('tn-debug_subtree',l.ft[m]);}k.evt_value=i.offsetHeight;if(j)k.offset=Math.max(0,i.offsetTop-j.offsetTop);return k;}f.exports=h;}),null);
__d('PagesLikeFollowNotifDispatcher',['Arbiter','ExplicitRegistrationReactDispatcher','PageLikeConstants','PagesLikeFollowNotifActions','SubscriptionsHandler'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('ExplicitRegistrationReactDispatcher'));i=h&&h.prototype;function j(k){i.constructor.call(this,k);var l=new (c('SubscriptionsHandler'))();l.addSubscriptions(c('Arbiter').subscribe(c('PageLikeConstants').LIKED,function(m,n){return this.dispatchLike(n.profile_id);}.bind(this)),c('Arbiter').subscribe(c('PageLikeConstants').UNLIKED,function(m,n){return this.dispatchUnlike(n.profile_id);}.bind(this)));}j.prototype.dispatchLike=function(k){this.dispatch({type:c('PagesLikeFollowNotifActions').LIKE,data:{pageID:k,likeStatus:true}});};j.prototype.dispatchUnlike=function(k){this.dispatch({type:c('PagesLikeFollowNotifActions').UNLIKE,data:{pageID:k,likeStatus:false}});};f.exports=new j({strict:true});}),null);
__d('PagesFollowStore',['FluxReduceStore','PagesLikeFollowNotifActions','PagesLikeFollowNotifDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('FluxReduceStore'));i=h&&h.prototype;j.prototype.getInitialState=function(){return {};};j.prototype.reduce=function(k,l){var m=babelHelpers['extends']({},k);switch(l.type){case c('PagesLikeFollowNotifActions').INIT_DATA:if(l.data.pageID in k)return k;m[l.data.pageID]=l.data.followStatus;return m;case c('PagesLikeFollowNotifActions').FOLLOW_CHANGED:m[l.data.pageID]=l.data.followStatus;return m;}return k;};function j(){h.apply(this,arguments);}f.exports=new j(c('PagesLikeFollowNotifDispatcher'));}),null);
__d('AbstractDockingElement',['Arbiter','Event','Run','SubscriptionsHandler','onEnclosingPageletDestroy','queryThenMutateDOM','removeFromArray'],(function a(b,c,d,e,f,g){var h=[],i=null;function j(){c('queryThenMutateDOM')(function(){return h.forEach(function(m){return m.queryDOM();});},function(){return h.forEach(function(m){return m.updateWithCache();});},'AbstractDockingElement');}function k(){if(!i){i=new (c('SubscriptionsHandler'))();i.addSubscriptions(c('Event').listen(window,'scroll',j),c('Event').listen(window,'resize',j),c('Run').onLeave(function(){while(h.length)l(h[0]);}));i=i;}return i;}function l(m){try{m.onPageletDestroyed&&c('Arbiter').unsubscribe(m.onPageletDestroyed);}catch(n){}finally{m.onPageletDestroyed=null;}if(!i||h.indexOf(m)===-1)return;c('removeFromArray')(h,m);if(h.length)return;i.release();i=null;}f.exports={register:function m(n,o,p){var q=k(),r={onPageletDestroyed:q.addSubscriptions(c('onEnclosingPageletDestroy')(n,function(){l(r);})),queryDOM:o,updateWithCache:p};h.push(r);}};}),null);
__d('DirectionalDockingElement',['AbstractDockingElement','Arbiter','DOM','Scroll','Style','UITinyViewportAction','UserAgent','ViewportBounds','getElementPosition','getStyleProperty','queryThenMutateDOM'],(function a(b,c,d,e,f,g){var h=true,i=false,j=c('UserAgent').isBrowser('Safari < 10')||c('UserAgent').isBrowser('Mobile Safari < 10');function k(l){'use strict';this.$DirectionalDockingElement5=0;this.$DirectionalDockingElement2=null;this.$DirectionalDockingElement7=false;this.$DirectionalDockingElement12=l;this.$DirectionalDockingElement8=0;this.$DirectionalDockingElement11=null;this.$DirectionalDockingElement13=0;this.register();this.$DirectionalDockingElement14=c('ViewportBounds').getTop();c('Style').set(this.$DirectionalDockingElement12,'width',this.$DirectionalDockingElement12.getBoundingClientRect().width+'px');this.$DirectionalDockingElement9=c('DOM').create('div');c('Style').set(this.$DirectionalDockingElement9,'position','relative');c('DOM').replace(this.$DirectionalDockingElement12,this.$DirectionalDockingElement9);c('DOM').appendContent(this.$DirectionalDockingElement9,this.$DirectionalDockingElement12);this.update();}k.prototype.register=function(){'use strict';c('AbstractDockingElement').register(this.getRoot(),this.__queryDOM.bind(this),this.__updateWithCache.bind(this));};k.prototype.subscribe=function(event,l,m){'use strict';if(!this.$DirectionalDockingElement1)this.$DirectionalDockingElement1=new (c('Arbiter'))();return this.$DirectionalDockingElement1.subscribe(event,l,m);};k.prototype.destroy=function(){'use strict';c('DOM').replace(this.$DirectionalDockingElement9,this.$DirectionalDockingElement12);};k.prototype.__queryDOM=function(){'use strict';var l=-c('getElementPosition')(this.$DirectionalDockingElement9).y;if(l!==this.$DirectionalDockingElement13){this.$DirectionalDockingElement15=l>this.$DirectionalDockingElement13?i:h;this.$DirectionalDockingElement13=l;}this.$DirectionalDockingElement6=this.$DirectionalDockingElement12.getBoundingClientRect();var m=document,n=m.body,o=m.documentElement;if(n&&o){var p=o.clientHeight,q=o.scrollHeight;this.$DirectionalDockingElement7=c('Scroll').getTop(n)+p>Math.max(p,q);}if(j){this.$DirectionalDockingElement11=c('getElementPosition')(this.$DirectionalDockingElement9);var r=parseInt(c('getStyleProperty')(this.$DirectionalDockingElement12,'left'),10);if(this.$DirectionalDockingElement11&&!isNaN(r)&&r!==this.$DirectionalDockingElement11.x)this.$DirectionalDockingElement11=babelHelpers['extends']({},this.$DirectionalDockingElement11,{x:r});}if(this.$DirectionalDockingElement12.style.position==='fixed')this.$DirectionalDockingElement5=c('getElementPosition')(this.$DirectionalDockingElement12).y+this.$DirectionalDockingElement13;};k.prototype.$DirectionalDockingElement16=function(l,m,n){'use strict';if(m===this.$DirectionalDockingElement4&&l===this.$DirectionalDockingElement3&&n===this.$DirectionalDockingElement2)return;var o=l!==this.$DirectionalDockingElement3,p={};if(m!==this.$DirectionalDockingElement4){p.top=m+'px';this.$DirectionalDockingElement4=m;}if(l!==this.$DirectionalDockingElement3){p.position=l;this.$DirectionalDockingElement3=l;}if(j)if(n!==this.$DirectionalDockingElement2){p.left=typeof n==='number'?n+'px':'auto';this.$DirectionalDockingElement2=n;}c('Style').apply(this.$DirectionalDockingElement12,p);if(o&&this.$DirectionalDockingElement1)this.$DirectionalDockingElement1.inform('changedposition');};k.prototype.$DirectionalDockingElement17=function(){'use strict';this.$DirectionalDockingElement16('fixed',this.$DirectionalDockingElement14,this.$DirectionalDockingElement11?this.$DirectionalDockingElement11.x:null);};k.prototype.$DirectionalDockingElement18=function(){'use strict';this.$DirectionalDockingElement16('fixed',this.$DirectionalDockingElement8,this.$DirectionalDockingElement11?this.$DirectionalDockingElement11.x:null);};k.prototype.$DirectionalDockingElement19=function(){'use strict';this.$DirectionalDockingElement16('absolute',this.$DirectionalDockingElement5,null);};k.prototype.unfixAndScrollBy=function(l){'use strict';this.$DirectionalDockingElement5=Math.max(0,this.$DirectionalDockingElement5-l);this.$DirectionalDockingElement19();};k.prototype.translateY=function(l){'use strict';var m=c('getElementPosition')(this.$DirectionalDockingElement12).y,n=c('getElementPosition')(this.$DirectionalDockingElement9).y,o=m-n;this.$DirectionalDockingElement5=l+o;this.$DirectionalDockingElement19();};k.prototype.__updateWithCache=function(){'use strict';var l=Math.round(this.$DirectionalDockingElement6.height);if(l!==this.$DirectionalDockingElement10){c('Style').set(this.$DirectionalDockingElement9,'height',l+'px');this.$DirectionalDockingElement10=l;this.$DirectionalDockingElement1&&this.$DirectionalDockingElement1.inform('changedheight');}if(this.$DirectionalDockingElement7)return;if(this.$DirectionalDockingElement13+this.$DirectionalDockingElement14<0||c('UITinyViewportAction').isTiny()){this.$DirectionalDockingElement5=0;this.$DirectionalDockingElement19();return;}if(this.$DirectionalDockingElement15===i&&this.$DirectionalDockingElement13+this.$DirectionalDockingElement8>=this.$DirectionalDockingElement5){this.$DirectionalDockingElement18();}else if(this.$DirectionalDockingElement15===h&&this.$DirectionalDockingElement13+this.$DirectionalDockingElement14<=this.$DirectionalDockingElement5){this.$DirectionalDockingElement17();}else this.$DirectionalDockingElement19();};k.prototype.update=function(){'use strict';c('queryThenMutateDOM')(function(){this.__queryDOM();}.bind(this),function(){this.__updateWithCache();}.bind(this));};k.prototype.setOffset=function(l){'use strict';return this.setOffsetAndTop(l,this.$DirectionalDockingElement14);};k.prototype.setOffsetAndTop=function(l,m){'use strict';c('queryThenMutateDOM')(function(){this.__queryDOM();this.$DirectionalDockingElement8=l;this.$DirectionalDockingElement14=m;}.bind(this),function(){this.__updateWithCache();}.bind(this));return this;};k.prototype.setTop=function(l){'use strict';return this.setOffsetAndTop(this.$DirectionalDockingElement8,l);};k.prototype.getPlaceholder=function(){'use strict';return this.$DirectionalDockingElement9;};k.prototype.getRoot=function(){'use strict';return this.$DirectionalDockingElement12;};f.exports=k;}),null);
__d('DockingElement',['AbstractDockingElement','Arbiter','CSS','DOM','DOMDimensions','Style','UserAgent','UITinyViewportAction','getElementPosition','mixin'],(function a(b,c,d,e,f,g){var h=c('UserAgent').isBrowser('Safari')||c('UserAgent').isBrowser('Mobile Safari');function i(j){'use strict';this.$DockingElement12=j;this.$DockingElement9=c('DOM').create('div');c('Style').set(this.$DockingElement9,'position','relative');c('DOM').replace(this.$DockingElement12,this.$DockingElement9);c('DOM').appendContent(this.$DockingElement9,this.$DockingElement12);this.$DockingElement8=0;this.register();this.update();}i.prototype.register=function(){'use strict';c('AbstractDockingElement').register(this.getRoot(),this.__queryDOM.bind(this),this.__updateWithCache.bind(this));};i.prototype.subscribe=function(event,j,k){'use strict';if(!this.$DockingElement1)this.$DockingElement1=new (c('Arbiter'))();return this.$DockingElement1.subscribe(event,j,k);};i.prototype.__queryDOM=function(){'use strict';this.$DockingElement11=c('getElementPosition')(this.getPlaceholder());this.$DockingElement5=c('DOMDimensions').getElementDimensions(this.$DockingElement12);};i.prototype.__updateWithCache=function(){'use strict';var j=this.$DockingElement8,k=this.getPlaceholder();if(!c('UITinyViewportAction').isTiny()&&this.$DockingElement11.y<=j){if(!this.$DockingElement7&&this.$DockingElement12.parentNode){c('CSS').addClass(this.$DockingElement12,'fixed_elem');this.$DockingElement7=true;}var l;if(this.$DockingElement4!==j){l={};l.top=j+'px';this.$DockingElement4=j;}var m=this.$DockingElement5.width;if(m!==this.$DockingElement3){l=l||{};l.width=m+'px';this.$DockingElement3=m;}if(h){var n=this.$DockingElement11.x;if(n!==this.$DockingElement2){l=l||{};l.left=n+'px';this.$DockingElement2=n;}}l&&c('Style').apply(this.$DockingElement12,l);var o=this.$DockingElement5.height;c('Style').set(k,'height',o+'px');if(o+1<this.$DockingElement10||o-1>this.$DockingElement10){this.$DockingElement10=o;this.$DockingElement1&&this.$DockingElement1.inform('changedheight');}}else if(this.$DockingElement7){c('Style').set(k,'height','');c('Style').apply(this.$DockingElement12,{left:'',top:'',width:''});c('CSS').removeClass(this.$DockingElement12,'fixed_elem');this.$DockingElement7=false;this.$DockingElement2=null;this.$DockingElement3=null;this.$DockingElement4=null;}};i.prototype.update=function(){'use strict';this.__queryDOM();this.__updateWithCache();};i.prototype.getPlaceholder=function(){'use strict';return this.$DockingElement9;};i.prototype.getRoot=function(){'use strict';return this.$DockingElement12;};i.prototype.setOffset=function(j){'use strict';this.$DockingElement8=j;this.update();return this;};f.exports=i;}),null);
__d('StickyRHC',['csx','$','Arbiter','DirectionalDockingElement','DockingElement','DOMDimensions','DOMQuery','Event','Run','SubscriptionsHandler','ViewportBounds','ge','getElementPosition','getViewportDimensions','removeFromArray','throttle'],(function a(b,c,d,e,f,g,h){var i=35,j=[],k;function l(z,aa){if(!aa||!aa.dom_id){j.forEach(m);return;}var ba=c('$')(aa.dom_id);for(var ca=0;ca<j.length;ca++)if(c('DOMQuery').contains(j[ca].getRoot(),ba)){m(j[ca]);return;}}function m(z){var aa=z.getRoot(),ba=z.updateOffset.bind(z),ca=c('DOMQuery').scry(aa,'img.img');ca.forEach(function(da){if(da.complete||da.getAttribute('height')||da.naturalHeight===undefined&&da.naturalHeight!==0)return;var ea=function ia(){ba();fa.remove();ga.remove();ha.remove();},fa=c('Event').listen(da,'load',ea),ga=c('Event').listen(da,'error',ea),ha=c('Event').listen(da,'abort',ea);});ba();}function n(){j.forEach(function(z){z.updateOffset();});}function o(){n();n();}function p(z){var aa=c('DOMQuery').scry(z,"._4-u2"),ba=c('DOMQuery').scry(z,"._4-u3"),ca=c('DOMQuery').scry(z,'.uiHeader'),da=c('DOMQuery').scry(z,'.ego_unit');return [].concat(aa,ba,ca,da).filter(function(ea){return t(ea)!==0;});}function q(z){return c('getElementPosition')(z).y;}function r(z,aa){return z-aa;}function s(){return t(c('ge')('pageFooter'));}function t(z){return z?c('DOMDimensions').getElementDimensions(z).height:0;}var u=v(n);function v(z){return function(aa){return c('Arbiter').subscribe(aa,z);};}function w(z,aa){var ba=arguments.length<=2||arguments[2]===undefined?true:arguments[2];'use strict';this.$StickyRHC1=z;this.$StickyRHC2=aa?new (c('DirectionalDockingElement'))(z):new (c('DockingElement'))(z);this.$StickyRHC3=ba;this.$StickyRHC2.subscribe('changedheight',this.updateOffset.bind(this));this.updateOffset();m(this);if(!j.length){k=new (c('SubscriptionsHandler'))();k.addSubscriptions(u('header_loaded'),u('browse_top_filters_full_width_displayed'),u('search_top_bar_displayed'),c('Arbiter').subscribe('netego_loaded',l),c('Arbiter').subscribe('video_fullscreen_change',o),c('Event').listen(window,'resize',c('throttle')(n)));}c('Run').onLeave(function(){return this.destroy();}.bind(this));j.push(this);}w.getInstances=function(){'use strict';return j;};w.prototype.getRoot=function(){'use strict';return this.$StickyRHC1;};w.prototype.subscribe=function(event,z){'use strict';return this.$StickyRHC2.subscribe(event,z);};w.prototype.destroy=function(){'use strict';this.$StickyRHC2=null;c('removeFromArray')(j,this);if(!j.length&&k){k.release();k=null;}};w.prototype.unfixAndScrollBy=function(z){'use strict';this.$StickyRHC2.unfixAndScrollBy(z);};w.prototype.updateOffset=function(){'use strict';this.$StickyRHC2.setOffset(this.calculateRHCOffset());};w.prototype.calculateRHCOffset=function(){'use strict';var z=this.getRoot(),aa=t(z),ba=x(),ca=y();if(aa<ca)return ba;if(this.$StickyRHC3){var da=p(z).map(q).sort(r),ea=aa+q(z);for(var fa=da,ga=Array.isArray(fa),ha=0,fa=ga?fa:fa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ia;if(ga){if(ha>=fa.length)break;ia=fa[ha++];}else{ha=fa.next();if(ha.done)break;ia=ha.value;}var ja=ia,ka=ea-ja;if(ka<ca)return ba-(aa-ka);}}return ba-(aa-ca);};function x(){return c('ViewportBounds').getTop();}function y(){var z=x(),aa=c('getViewportDimensions')().height,ba=s();return aa-z-i-ba;}f.exports=w;}),null);
__d('StreamViewportTracking',['DataAttributeUtils','DOM','DOMDimensions','ViewportTracking','ge','recordTNTreeData','viewportTrackingBuilder'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=51;function k(n,o,p){var q=arguments.length<=3||arguments[3]===undefined?j:arguments[3];return {_stream:null,getDataFromConfig:function r(s,t){t.isTimetrackingEnabled=true;},getAllStories:function r(){var s=c('DOM').scry(this.getStream(),p);return s.filter(function(t){return c('DataAttributeUtils').getDataFt(t);});},getStream:function r(){if(o)return o;if(!this._stream)this._stream=c('ge')('home_stream');return this._stream;},getStoryID:function r(s){var t=JSON.parse(c('DataAttributeUtils').getDataFt(s));return t&&t.mf_story_key;},getDataToLog:function r(s){var t=this.getStream(),u=c('recordTNTreeData')(s,t),v=s.getAttribute('data-insertion-position');if(v!==null)u.inspos=v;u.evt=q;u.vpv_time=Math.round(Date.now()/1000);var w=c('DOM').scry(s,'.fbStoryAttachmentImage')[0];if(w){var x=c('DOMDimensions').getElementDimensions(w);u.story_image_height=x.height;u.story_image_width=x.width;}return {ft:u};}};}h=babelHelpers.inherits(l,c('ViewportTracking'));i=h&&h.prototype;l.prototype.getQueryID=function(n){var o=JSON.parse(c('DataAttributeUtils').getDataFt(n));return o.qid;};l.prototype.getFBFeedLocations=function(n){var o=JSON.parse(c('DataAttributeUtils').getDataFt(n));return o.fbfeed_location;};l.prototype.getFBFeedInsertionPosition=function(n){var o=JSON.parse(c('DataAttributeUtils').getDataFt(n));return o.insertion_position;};l.prototype.getTimetrackingDataToLog=function(n){var o=i.getTimetrackingDataToLog.call(this,n);if(this.ctaLoggingEnabled){var p=c('DOM').scry(n.story,'[data-is-cta]').map(function(q){var r=c('DataAttributeUtils').getDataFt(q),s=r&&JSON.parse(r);return s&&s.cta_types;}).filter(function(q){return !!q;});if(p.length>0)o.ft.cta_types=p;}return o;};l.prototype.cleanup=function(){m.clearSingleton();i.cleanup.call(this);};function l(){h.apply(this,arguments);}var m=c('viewportTrackingBuilder')(function(n,o){var p=new l(k(n,o,'.uiStreamStory'));p.init(n);return p;});l.factory=m.factory.bind(m);l.singleton=m.singleton.bind(m);l.clearSingleton=m.clearSingleton.bind(m);l.getBehavior=k;f.exports=l;}),null);
__d('XUISubNavigationLoader',['cx','csx','AjaxPipeRequest','CSS','DOM','FIGEntityPageLayout','PageHooks','PageTransitions','PageTransitionsRegistrar','Parent','Run','createCancelableFunction'],(function a(b,c,d,e,f,g,h,i){var j="._3o_h",k='content_container',l="_4t7n",m="._4t7n",n="_2fvv",o="_2yap",p="._2yap",q=null,r=[],s=[],t=null;function u(w){for(var x=r,y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var aa;if(y){if(z>=x.length)break;aa=x[z++];}else{z=x.next();if(z.done)break;aa=z.value;}var ba=aa;if(ba(w))return true;}c('Run').onLeave(function(){c('PageTransitionsRegistrar').removeHandler(u,6);s.forEach(function(ca){return ca();});s=[];r=[];});return false;}var v={setLoading:function w(x,y){c('CSS').conditionClass(x,l,y);},setSelected:function w(x){var y=c('Parent').byClass(x,n);c('DOM').scry(y,j).forEach(function(z){c('DOM').remove(z);});c('DOM').scry(y,p).forEach(function(z){c('CSS').removeClass(z,o);});c('CSS').addClass(x,o);},cancelRequest:function w(x){if(q){q.abort();q=null;c('DOM').scry(c('Parent').byClass(x,n),m).forEach(function(y){c('CSS').removeClass(y,l);});}},sendRequest:function w(x,y,z){v.cancelRequest(z);v.setSelected(z);v.setLoading(z,true);c('PageHooks').runHooks('onleavehooks');q=new (c('AjaxPipeRequest'))().setURI(y).setData(babelHelpers['extends']({},x.getQueryData(),{path:x.getPath()})).setCanvasId(k).setFirstResponseHandler(function(){v.setLoading(z,false);}).setFinallyHandler(function(){q=null;c('FIGEntityPageLayout').update();c('PageTransitions').transitionComplete(true);}).send();},registerHandler:function w(x){if(!r.length)c('PageTransitionsRegistrar').registerHandler(u,6);if(t)t.remove();r.push(x);},onLeave:function w(x){if(!r.length&&!t)t=c('Run').onLeave(function(){s.forEach(function(y){return y();});s=[];});x=c('createCancelableFunction')(x);s.push(x);return {remove:function y(){x.cancel();}};}};f.exports=v;}),null);
__d('EntityPageDirectionalDockingElement',['DirectionalDockingElement','EntityPageDockingElementController'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('DirectionalDockingElement'));i=h&&h.prototype;j.prototype.register=function(){'use strict';c('EntityPageDockingElementController').register(this.__queryDOM.bind(this),this.__updateWithCache.bind(this));};function j(){'use strict';h.apply(this,arguments);}f.exports=j;}),null);
__d('EntityPageDockingElementController',['Event','SubscriptionsHandler','XUISubNavigationLoader','queryThenMutateDOM','throttle'],(function a(b,c,d,e,f,g){var h=[],i=null,j=c('throttle')(function(){c('queryThenMutateDOM')(function(){return h.forEach(function(l){return l.queryDOM();});},function(){return h.forEach(function(l){return l.updateWithCache();});},'EntityPageDockingElementController');}),k={register:function l(m,n){if(!i){i=new (c('SubscriptionsHandler'))();i.addSubscriptions(c('Event').listen(window,'scroll',j),c('Event').listen(window,'resize',j),c('XUISubNavigationLoader').onLeave(function(){h=[];if(i){i.release();i=null;}}));}var o={queryDOM:m,updateWithCache:n};h.push(o);}};f.exports=k;}),null);
__d('getEntityPageDockingElementOffset',[],(function a(b,c,d,e,f,g){'use strict';var h=function i(j,k,l){var m=l.getRootBoundingClientRect(),n=m.height,o=m.top,p=l.getPlaceholderBoundingClientRect(),q=p.top,r=j-n,s=l.getSections();if(s){var t=Array.from(s).map(function(x){return q+x.getBoundingClientRect().top-o;});t.sort(function(x,y){return x-y;});for(var u=0,v=t.length;u<v;u++){var w=t[u]-q;if(n-w<j-k){r=k-w;break;}}}return r;};f.exports=h;}),null);
__d('EntityPageRegion',['DirectionalDockingElement','getElementRect','getEntityPageDockingElementOffset','memoize','uniqueID'],(function a(b,c,d,e,f,g){'use strict';function h(i,j,k){this.$EntityPageRegion9=function(){return c('getElementRect')(this.$EntityPageRegion1.getPlaceholder());}.bind(this);this.$EntityPageRegion10=function(){return c('getElementRect')(this.$EntityPageRegion1.getRoot());}.bind(this);this.$EntityPageRegion1=i;this.$EntityPageRegion2=c('uniqueID')();this.$EntityPageRegion3=0;this.$EntityPageRegion4=false;this.$EntityPageRegion5=k;this.$EntityPageRegion6=j;this.$EntityPageRegion7=0;this.$EntityPageRegion8=false;this.getPlaceholderBoundingClientRect=c('memoize')(this.$EntityPageRegion9);this.getRootBoundingClientRect=c('memoize')(this.$EntityPageRegion10);}h.prototype.calculateOffset=function(i,j){if(this.$EntityPageRegion5)return this.$EntityPageRegion5(i,j,this);if(this.getRootBoundingClientRect().height+j<i){return j;}else return c('getEntityPageDockingElementOffset')(i,j,this);};h.prototype.getID=function(){return this.$EntityPageRegion2;};h.prototype.getOffset=function(){return this.$EntityPageRegion3;};h.prototype.getTop=function(){return this.$EntityPageRegion7;};h.prototype.getSections=function(){var i=this.$EntityPageRegion6;if(!i)return null;return this.$EntityPageRegion1.getPlaceholder().querySelectorAll(i);};h.prototype.setOffset=function(i){if(i===this.$EntityPageRegion3)return;this.$EntityPageRegion3=i;this.$EntityPageRegion4=true;};h.prototype.setTop=function(i){if(i===this.$EntityPageRegion7)return;this.$EntityPageRegion7=i;this.$EntityPageRegion8=true;};h.prototype.update=function(){var i=this.$EntityPageRegion4,j=this.$EntityPageRegion8,k=this.$EntityPageRegion1,l=this.$EntityPageRegion3,m=this.$EntityPageRegion7;if(k instanceof c('DirectionalDockingElement')&&j){if(i){k.setOffsetAndTop(l,m);}else k.setTop(m);}else if(i)k.setOffset(l);this.$EntityPageRegion4=false;this.$EntityPageRegion8=false;this.getPlaceholderBoundingClientRect=c('memoize')(this.$EntityPageRegion9);this.getRootBoundingClientRect=c('memoize')(this.$EntityPageRegion10);};f.exports=h;}),null);
__d('FIGEntityPageLayout',['Arbiter','DirectionalDockingElement','Event','EntityPageConfig','EntityPageDirectionalDockingElement','EntityPageRegion','MutationObserver','ResizeEventHandler','Run','SubscriptionsHandler','ViewportBounds','XUISubNavigationLoader','getViewportDimensions','queryThenMutateDOM','removeFromArray','throttle'],(function a(b,c,d,e,f,g){'use strict';var h=[],i=null,j=null,k=null,l=null,m={attributes:false,characterData:true,childList:true,subtree:true};function n(){c('queryThenMutateDOM')(function(){var t=c('getViewportDimensions')().height,u=c('ViewportBounds').getTop();h.sort(function(v,w){return v.getPlaceholderBoundingClientRect().top<w.getPlaceholderBoundingClientRect().top?-1:1;});h.forEach(function(v){var w=v.getRootBoundingClientRect(),x=w.width,y=v.getPlaceholderBoundingClientRect(),z=y.left,aa=y.top,ba=u;h.forEach(function(da){var ea=da.getRootBoundingClientRect(),fa=ea.height,ga=ea.width,ha=da.getPlaceholderBoundingClientRect(),ia=ha.left,ja=ha.top;if(v!==da&&ja+fa<=aa&&Math.min(z+x,ia+ga)>=Math.max(z,ia))ba+=fa+da.getOffset()-da.getTop();});var ca=v.calculateOffset(t,ba);v.setOffset(ca);v.setTop(ba);});},function(){h.forEach(function(t,u){t.update();});},'EntityPageLayout');}function o(){p();if(!k){k=new (c('SubscriptionsHandler'))();k.addSubscriptions(c('Run').onLeave(q));}return k;}function p(){if(!j){j=new (c('SubscriptionsHandler'))();j.addSubscriptions(c('ViewportBounds').subscribe('change',n),c('Arbiter').subscribe('footerLoaded',n),c('Event').listen(window,'resize',c('throttle')(n)),c('XUISubNavigationLoader').onLeave(function(){if(j){j.release();j=null;}if(l){l.disconnect();l=null;}if(i)i=null;}));}return j;}function q(){if(k){k.release();k=null;}}function r(t,u,v,w,x){var y=new (c('EntityPageRegion'))(v,u?u.join(','):null,x);h.push(y);n();w.addSubscriptions(v.subscribe('changedheight',n),c('Event').listen(t,'resize',n));if(c('EntityPageConfig').hasMutationObserver){if(!l){i=new (c('ResizeEventHandler'))(n);l=new (c('MutationObserver'))(i.handleEvent);}l.observe(t,m);}return function z(){c('removeFromArray')(h,y);if(h.length===0)q();};}var s={register:function t(u,v,w,x){var y=w?new w(u):new (c('DirectionalDockingElement'))(u),z=r(u,v,y,o(),x);return {remove:function aa(){z();y.destroy();}};},registerAcrossTransitions:function t(u,v,w,x){var y=w?new w(u):new (c('EntityPageDirectionalDockingElement'))(u),z=r(u,v,y,p(),x);return {remove:function aa(){z();y.destroy();}};},update:n};f.exports=s;}),null);
__d('XUISubNavigation',['cx','CSS','Event','Parent','Run','SubscriptionsHandler','URI','XUISubNavigationLoader'],(function a(b,c,d,e,f,g,h){var i="_8ue",j="_2yaa";function k(l,m){'use strict';this.$XUISubNavigation1=l;c('XUISubNavigationLoader').registerHandler(function(n){return this.$XUISubNavigation3(n);}.bind(this));this.$XUISubNavigation2=new (c('SubscriptionsHandler'))();this.$XUISubNavigation2&&this.$XUISubNavigation2.addSubscriptions(c('Event').listen(this.$XUISubNavigation1,'click',function(event){var n=c('Parent').byClass(event.target,j);if(n instanceof HTMLElement&&n.getAttribute('data-endpoint'))c('XUISubNavigationLoader').setSelected(n);}),c('Event').listen(this.$XUISubNavigation1,'focusin',this.$XUISubNavigation4.bind(this)),c('Event').listen(this.$XUISubNavigation1,'focusout',this.$XUISubNavigation5.bind(this)),c('XUISubNavigationLoader').onLeave(this.destroy.bind(this)));if(m)this.$XUISubNavigation2&&this.$XUISubNavigation2.addSubscriptions(c('Event').listen(m,'click',function(event){event.preventDefault();c('CSS').addClass(this.$XUISubNavigation1,"_5rll");c('Event').fire(this.$XUISubNavigation1,'resize');}.bind(this)));}k.prototype.destroy=function(){'use strict';this.$XUISubNavigation2&&this.$XUISubNavigation2.release();this.$XUISubNavigation2=null;};k.prototype.$XUISubNavigation4=function(event){'use strict';var l=c('Parent').byClass(event.target,j);if(l)c('CSS').addClass(l,i);};k.prototype.$XUISubNavigation5=function(event){'use strict';var l=c('Parent').byClass(event.target,j);if(l&&!l.contains(event.relatedTarget))c('CSS').removeClass(l,i);};k.prototype.$XUISubNavigation3=function(l){'use strict';var m=l.getPath(),n=Array.prototype.find.call(this.$XUISubNavigation1.getElementsByTagName('a'),function(p){return new (c('URI'))(p.href).getPath()===m&&p.hasAttribute('data-endpoint');});if(n){var o=c('Parent').byClass(n,j);if(o instanceof HTMLElement){c('XUISubNavigationLoader').sendRequest(l,new (c('URI'))(n.getAttribute('data-endpoint')),o);return true;}return false;}return false;};f.exports=k;}),null);